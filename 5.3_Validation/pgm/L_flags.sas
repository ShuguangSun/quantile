
%MACRO freq(ccs)/parmbuff;
%let stop=%length(&syspbuff);
%do i=1 %to &stop;
%let var=%scan(&syspbuff,&i);
%if &var ne %then %do; 

PROC FREQ DATA=datain NOPRINT;
	TABLES &yvar * &var._F / NOCUM 	OUT=WORK.freq;
RUN;
PROC SQL;
CREATE TABLE WORK.FTable AS 
SELECT * FROM WORK.FTable
 OUTER UNION CORR 
SELECT
	"&RCC" as country,
	&yvar as year,
	"&var" as VARNAM, 
	&var._F as VALUE,
	COUNT
FROM WORK.FREQ;
Quit;

%end;
%else %let i=&stop;
%end;
%MEND freq;


%MACRO crtab;
PROC SQL;
 CREATE TABLE Ftable
	 (country char(2),
	 year num,
	 varnam char(8),
	 value num ,
	 count num);
QUIT;
%MEND crtab;

%MACRO tab;
PROC TABULATE DATA=WORK.FTABLE;
	VAR count;
	CLASS country;
	CLASS year /	ORDER=UNFORMATTED MISSING;
	CLASS varnam /	ORDER=UNFORMATTED MISSING;
	CLASS value /	ORDER=UNFORMATTED MISSING;
	TABLE country="", varnam=""*year="",
	value="" *count=""* (Min="N"*F=6.0 rowpctSUM="%"*F=6.2)
		/BOX={LABEL=_PAGE_ STYLE={FONT_SIZE=6}};
RUN;
%MEND tab;

libname lib "&G_PING_RAWDB/&cc./&ss&yy";

ODS HTML path="&G_PING_RAWDB/&cc./&ss&yy/" body="flags.html" style=EGdefault nogtitle;
TITLE;

DATA datain;
set lib.&ss.&cc.&yy.d;
RUN;
%crtab;
%let yvar=DB010;
%freq (DB040 DB050 DB060 DB062 DB070 DB075 DB080 DB090 DB100 DB110 DB120 DB130 DB135); 
%tab;


DATA datain;
set lib.&ss.&cc.&yy.r;
RUN;
%crtab;
%let yvar=RB010;
%freq (RB031 RB060 RB062 RB063 RB064 RB070 RB080 RB090 RB100 RB110 RB120 RB140 RB150 RB160 RB170 RB180 RB190 RB200 
		RB210 RB220 RB230 RB240 RB245 RB250 RB260 RB270); 
%tab;


DATA datain;
set lib.&ss.&cc.&yy.h;
RUN;
%crtab;
%let yvar=HB010;
%freq (HB040 HB050 HB060 HB070 HB080 HB090 HB100 HS010 HS011 
		HS020 HS021 HS030 HS031 HS040 HS050 HS060 HS070 HS080 HS090 HS100 HS110 HS120 HS130 HS140 HS150 
		HH010 HH020 HH030 HH031 HH040 HH050 HH060 HH061 HH080 HH081 HH090 HH091); 
%tab;

%crtab;
%freq (HY010 HY020 HY022 HY023 HY025 
	HY030N HY040N HY050N HY060N HY070N HY080N HY080N HY090N HY100N HY110N HY120N HY130N HY131N HY140N HY145N
	HY030G HY040G HY050G HY060G HY070G HY080G HY081G HY090G HY100G HY110G HY120G HY130G HY131G HY140G); 
%tab;


DATA datain;
set lib.&ss.&cc.&yy.p;
RUN;
%crtab;
%let yvar=PB010;
%freq (PB050 PB070 PB080 PB090 PB100 PB110 PB120 PB130 PB140 PB150 PB160 PB170 PB180 PB190 
		PB200 PE040 PL030 PL031 PL020 PL025 PL040 PL050 PL060 PL140 PL160 PL170 PL180 PL190 PL200 
		PL210A PL210B PL210C PL210D PL210E PL210F PL210G PL210H PL210I PL210J PL210K PL210L
		PL211A PL211B PL211C PL211D PL211E PL211F PL211G PL211H PL211I PL211J PL211K PL211L  
		PH010 PH020 PH030); 
%tab;

%crtab;
%freq ( PY010N PY020N PY021N PY035N PY050N PY070N PY080N PY090N PY100N PY110N PY120N PY130N PY140N 
		PY010G PY020G PY021G PY030G PY031G PY035G PY050G PY070G PY080G PY090G PY100G PY110G 
		PY120G PY130G PY140G); 
%tab;

ODS HTML CLOSE;
