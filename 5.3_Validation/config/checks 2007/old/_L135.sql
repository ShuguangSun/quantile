put 'title1 "Check #135 / &datum";';
put 'title2 "&ccnam - &surtyp survey &suryear";';
put 'title3 "Structural - Error: RB110 must be 2 in the new household for a sample person moved from another household";';
put "PROC SQL;";
put "Create table tempo as";
put "select a.RHID,a.RB010,a.RB030,a.RB100,a.RB110,a.RB120,b.RHID as _RHID,b.RB010 as  _RB010,b.RB030 as _RB030,b.RB110 as _RB110, c.DB010, c.DB030, c.DB135 ";
put "from (l%nrstr(&cc).&yy.r as a left join l%nrstr(&cc).&yy.r as b on a.RB030 = b.RB030 and a.RHID ne b.RHID and a.RB010 = b.RB010)";
put "left join l%nrstr(&cc).&yy.d as c on b.RHID = c.DB030 and b.RB010 = c.DB010";
put "where a.RB100 = 1 and a.RB110 = 5 and a.RB120 = 1 and b.RB110 ne 2 and c.DB135 = 1;";
put "Select * from tempo(obs=%nrstr(&errmax));";
put "Insert into errtabl set cod = 135 , error = (select count(*) from tempo);";
put "QUIT;";